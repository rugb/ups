<%= form_for(@user) do |f| %>
<fieldset>
<% if @user.errors.any? %>
  <div id="error_explanation">
    <h2><%= pluralize(@user.errors.count, "error") %>
      prohibited this user from being saved:</h2>
    <ul>
      <% @user.errors.full_messages.each do |msg| %>
      <li>
        <%= msg %>
      </li>
      <% end %>
    </ul>
  </div>
  <% end %>
  <div class="field">
    <label>
      OpenID:
    </label>
    <% if @user.new_record? %>
      <%= f.text_field :openid %>
    <% else %>
      <span>
        <%= @user.openid  %>
      </span>
    <% end %>
  </div>
  <div class="field">
    <label>
      name:
    </label>
    <%= f.text_field :name %>
  </div>
  <div class="field">
    <label>
      fullname:
    </label>
    <%= f.text_field :fullname %>
  </div>
  <div class="field">
    <label>
      email:
    </label>
    <%= f.text_field :email %>
  </div>
  <% if has_role?(:admin) && @user != @current_user%>
  <div class="field">
    <label>
      role:
    </label>
    <%= f.select :role_id, role_options %>
  </div>
  <% end %>
  <div class="actions">
    <%= f.submit :class => "continue" %>
  </div>
</fieldset>
<% end %>